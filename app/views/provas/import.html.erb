<div class="space-y-6">
  <div>
    <%= link_to "‚Üê Voltar para provas", provas_path, class: "text-sm font-semibold text-slate-700 hover:text-slate-900" %>
  </div>

  <div>
    <p class="text-sm font-semibold text-slate-600">Importar Provas</p>
    <h1 class="mt-2 text-2xl font-bold tracking-tight text-slate-900">Carregar provas via CSV</h1>
    <p class="mt-1 text-slate-600">Importe m√∫ltiplas provas com quest√µes, respostas e gabaritos de uma s√≥ vez usando um arquivo CSV.</p>
  </div>

  <div class="rounded-2xl border border-slate-200/80 bg-white p-6 shadow-sm ring-1 ring-black/5">
    <div class="mb-6">
      <h2 class="text-lg font-semibold text-slate-900">Formato esperado do CSV</h2>
      <p class="mt-2 text-sm text-slate-600">Seu arquivo deve ter as seguintes colunas (na primeira linha):</p>
      
      <div class="mt-4 overflow-x-auto">
        <table class="min-w-full border-collapse border border-slate-300">
          <thead class="bg-slate-100">
            <tr>
              <th class="border border-slate-300 px-4 py-2 text-left text-sm font-semibold text-slate-900">Coluna</th>
              <th class="border border-slate-300 px-4 py-2 text-left text-sm font-semibold text-slate-900">Exemplo</th>
              <th class="border border-slate-300 px-4 py-2 text-left text-sm font-semibold text-slate-900">Obrigat√≥rio</th>
              <th class="border border-slate-300 px-4 py-2 text-left text-sm font-semibold text-slate-900">Observa√ß√£o</th>
            </tr>
          </thead>
          <tbody>
            <tr class="bg-slate-50">
              <td class="border border-slate-300 px-4 py-2 text-sm font-semibold text-slate-700">üîπ Informa√ß√µes da Prova</td>
              <td colspan="3" class="border border-slate-300 px-4 py-2 text-sm text-slate-600"></td>
            </tr>
            <tr>
              <td class="border border-slate-300 px-4 py-2 text-sm text-slate-600"><code class="bg-slate-100 px-2 py-1 rounded">prova_titulo</code></td>
              <td class="border border-slate-300 px-4 py-2 text-sm text-slate-600">Prova 1 - Matem√°tica</td>
              <td class="border border-slate-300 px-4 py-2 text-sm"><span class="inline-flex rounded-full bg-red-100 px-2 py-1 text-xs font-semibold text-red-800">Sim</span></td>
              <td class="border border-slate-300 px-4 py-2 text-sm text-slate-600">Nome da prova</td>
            </tr>
            <tr>
              <td class="border border-slate-300 px-4 py-2 text-sm text-slate-600"><code class="bg-slate-100 px-2 py-1 rounded">aluno_ra</code></td>
              <td class="border border-slate-300 px-4 py-2 text-sm text-slate-600">A234567-T123456</td>
              <td class="border border-slate-300 px-4 py-2 text-sm"><span class="inline-flex rounded-full bg-green-100 px-2 py-1 text-xs font-semibold text-green-800">Opcional</span></td>
              <td class="border border-slate-300 px-4 py-2 text-sm text-slate-600">RA do aluno (deixe vazio para sem aluno)</td>
            </tr>
            <tr>
              <td class="border border-slate-300 px-4 py-2 text-sm text-slate-600"><code class="bg-slate-100 px-2 py-1 rounded">data_criacao</code></td>
              <td class="border border-slate-300 px-4 py-2 text-sm text-slate-600">2026-02-12</td>
              <td class="border border-slate-300 px-4 py-2 text-sm"><span class="inline-flex rounded-full bg-green-100 px-2 py-1 text-xs font-semibold text-green-800">Opcional</span></td>
              <td class="border border-slate-300 px-4 py-2 text-sm text-slate-600">Formato YYYY-MM-DD</td>
            </tr>
            <tr class="bg-slate-50">
              <td class="border border-slate-300 px-4 py-2 text-sm font-semibold text-slate-700">üîπ Informa√ß√µes das Quest√µes</td>
              <td colspan="3" class="border border-slate-300 px-4 py-2 text-sm text-slate-600"></td>
            </tr>
            <tr>
              <td class="border border-slate-300 px-4 py-2 text-sm text-slate-600"><code class="bg-slate-100 px-2 py-1 rounded">questao_enunciado</code></td>
              <td class="border border-slate-300 px-4 py-2 text-sm text-slate-600">Quanto √© 2 + 2?</td>
              <td class="border border-slate-300 px-4 py-2 text-sm"><span class="inline-flex rounded-full bg-red-100 px-2 py-1 text-xs font-semibold text-red-800">Sim*</span></td>
              <td class="border border-slate-300 px-4 py-2 text-sm text-slate-600">Texto da quest√£o (*se houver quest√µes)</td>
            </tr>
            <tr>
              <td class="border border-slate-300 px-4 py-2 text-sm text-slate-600"><code class="bg-slate-100 px-2 py-1 rounded">questao_tipo</code></td>
              <td class="border border-slate-300 px-4 py-2 text-sm text-slate-600">multipla_escolha</td>
              <td class="border border-slate-300 px-4 py-2 text-sm"><span class="inline-flex rounded-full bg-green-100 px-2 py-1 text-xs font-semibold text-green-800">Opcional</span></td>
              <td class="border border-slate-300 px-4 py-2 text-sm text-slate-600">Tipo de quest√£o</td>
            </tr>
            <tr>
              <td class="border border-slate-300 px-4 py-2 text-sm text-slate-600"><code class="bg-slate-100 px-2 py-1 rounded">questao_peso</code></td>
              <td class="border border-slate-300 px-4 py-2 text-sm text-slate-600">1.0</td>
              <td class="border border-slate-300 px-4 py-2 text-sm"><span class="inline-flex rounded-full bg-green-100 px-2 py-1 text-xs font-semibold text-green-800">Opcional</span></td>
              <td class="border border-slate-300 px-4 py-2 text-sm text-slate-600">Peso/pontua√ß√£o (padr√£o: 1.0)</td>
            </tr>
            <tr>
              <td class="border border-slate-300 px-4 py-2 text-sm text-slate-600"><code class="bg-slate-100 px-2 py-1 rounded">questao_respostas</code></td>
              <td class="border border-slate-300 px-4 py-2 text-sm text-slate-600">A) 3 | B) 4 | C) 5</td>
              <td class="border border-slate-300 px-4 py-2 text-sm"><span class="inline-flex rounded-full bg-green-100 px-2 py-1 text-xs font-semibold text-green-800">Opcional</span></td>
              <td class="border border-slate-300 px-4 py-2 text-sm text-slate-600">Op√ß√µes de resposta separadas por |</td>
            </tr>
            <tr>
              <td class="border border-slate-300 px-4 py-2 text-sm text-slate-600"><code class="bg-slate-100 px-2 py-1 rounded">resposta_colocada</code></td>
              <td class="border border-slate-300 px-4 py-2 text-sm text-slate-600">B</td>
              <td class="border border-slate-300 px-4 py-2 text-sm"><span class="inline-flex rounded-full bg-green-100 px-2 py-1 text-xs font-semibold text-green-800">Opcional</span></td>
              <td class="border border-slate-300 px-4 py-2 text-sm text-slate-600">Resposta do aluno (se j√° respondeu)</td>
            </tr>
            <tr>
              <td class="border border-slate-300 px-4 py-2 text-sm text-slate-600"><code class="bg-slate-100 px-2 py-1 rounded">resposta_correta</code></td>
              <td class="border border-slate-300 px-4 py-2 text-sm text-slate-600">B</td>
              <td class="border border-slate-300 px-4 py-2 text-sm"><span class="inline-flex rounded-full bg-red-100 px-2 py-1 text-xs font-semibold text-red-800">Sim*</span></td>
              <td class="border border-slate-300 px-4 py-2 text-sm text-slate-600">Resposta correta (cria gabarito)</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="mt-4 p-4 rounded-lg bg-blue-50 border border-blue-200">
        <p class="text-sm text-blue-900"><strong>üí° Dicas:</strong></p>
        <ul class="mt-2 text-sm text-blue-900 list-disc list-inside space-y-1">
          <li>Cada linha = uma quest√£o. Use mesmo t√≠tulo/aluno/data para agrupar quest√µes da mesma prova</li>
          <li>Deixe questao_enunciado vazio para linhas que s√≥ t√™m informa√ß√µes de prova</li>
          <li>Respostas iguais com espa√ßos diferentes s√£o consideradas iguais (ex: "B", " B ", "b")</li>
        </ul>
      </div>
    </div>

    <div class="border-t border-slate-200 pt-6">
      <%= form_with url: process_import_provas_path, method: :post, local: true, class: "space-y-4" do |f| %>
        <div>
          <%= f.label :csv_file, "Selecione o arquivo CSV", class: "block text-sm font-semibold text-slate-900" %>
          <%= f.file_field :csv_file, accept: '.csv', class: "mt-2 block w-full rounded-xl border border-slate-300/80 bg-white/80 px-3 py-2.5 text-sm text-slate-900 shadow-sm outline-none transition focus:border-indigo-400 focus:ring-2 focus:ring-indigo-200", required: true %>
          <p class="mt-1 text-xs text-slate-600">Apenas arquivos CSV s√£o aceitos</p>
        </div>

        <div class="flex gap-3 pt-2">
          <%= f.submit "Importar provas", class: "inline-flex items-center justify-center rounded-xl bg-gradient-to-r from-indigo-600 to-sky-600 px-5 py-3 text-sm font-semibold text-white shadow-sm shadow-indigo-200/60 transition hover:-translate-y-0.5 hover:shadow-md focus:outline-none focus:ring-2 focus:ring-indigo-400 focus:ring-offset-2" %>
          <%= link_to "Cancelar", provas_path, class: "inline-flex items-center justify-center rounded-xl border border-slate-300/80 bg-white px-5 py-3 text-sm font-semibold text-slate-900 shadow-sm transition hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-slate-300 focus:ring-offset-2" %>
        </div>
      <% end %>
    </div>
  </div>

  <div class="rounded-2xl border border-slate-200/80 bg-slate-50/60 p-6 ring-1 ring-black/5">
    <h3 class="text-sm font-semibold text-slate-900">Exemplo de arquivo CSV v√°lido:</h3>
    <pre class="mt-3 overflow-x-auto rounded-lg bg-white p-3 text-xs text-slate-700 border border-slate-200"><code>prova_titulo,aluno_ra,data_criacao,questao_enunciado,questao_tipo,questao_peso,questao_respostas,resposta_colocada,resposta_correta
Prova 1 - Matem√°tica,A234567-T123456,2026-02-12,Quanto √© 2 + 2?,multipla_escolha,1.0,A) 3 | B) 4 | C) 5 | D) 6,,B
Prova 1 - Matem√°tica,A234567-T123456,2026-02-12,Qual √© a raiz quadrada de 16?,multipla_escolha,1.0,A) 2 | B) 4 | C) 6 | D) 8,,B
Prova 2 - Hist√≥ria,A345678-T234567,2026-02-12,Em que ano foi descoberto o Brasil?,multipla_escolha,2.0,A) 1400 | B) 1500 | C) 1600 | D) 1700,,B</code></pre>
  </div>
</div>

